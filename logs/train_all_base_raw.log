=== Training All Base DUV Models (Raw Data) ===
Epochs: 15, Batch Size: 256
Device: mps

>>> [1/5] Training Guitar Base Model...
INFO:root:device mps amp=False precision=medium
INFO:root:train rows kept 3205872 removed 0 | val kept 356209 removed 0
INFO:root:class balance {'pos': 0, 'neg': 3205872}
WARNING:root:duv_mode=both with zero class-loss weights; setting w_vel_cls=0.5, w_dur_cls=0.5
INFO:root:epoch 1 train_loss 1.3886 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 1.0s
INFO:root:epoch=1 train_loss=1.388555 val_loss=0.693147 | train_loss 1.388555 val_loss 0.693147
INFO:root:epoch 2 train_loss 1.2988 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=2 train_loss=1.298771 val_loss=0.693147 | train_loss 1.298771 val_loss 0.693147
INFO:root:epoch 3 train_loss 0.7604 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=3 train_loss=0.760439 val_loss=0.693147 | train_loss 0.760439 val_loss 0.693147
INFO:root:epoch 4 train_loss 0.1270 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=4 train_loss=0.127012 val_loss=0.693147 | train_loss 0.127012 val_loss 0.693147
INFO:root:epoch 5 train_loss 0.6377 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=5 train_loss=0.637729 val_loss=0.693147 | train_loss 0.637729 val_loss 0.693147
INFO:root:epoch 6 train_loss 0.7912 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=6 train_loss=0.791245 val_loss=0.693147 | train_loss 0.791245 val_loss 0.693147
INFO:root:epoch 7 train_loss 0.5076 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=7 train_loss=0.507605 val_loss=0.693147 | train_loss 0.507605 val_loss 0.693147
INFO:root:epoch 8 train_loss 0.1381 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=8 train_loss=0.138136 val_loss=0.693147 | train_loss 0.138136 val_loss 0.693147
INFO:root:epoch 9 train_loss 0.1386 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=9 train_loss=0.138569 val_loss=0.693147 | train_loss 0.138569 val_loss 0.693147
INFO:root:epoch 10 train_loss 0.2683 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=10 train_loss=0.268319 val_loss=0.693147 | train_loss 0.268319 val_loss 0.693147
INFO:root:epoch 11 train_loss 0.2818 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=11 train_loss=0.281787 val_loss=0.693147 | train_loss 0.281787 val_loss 0.693147
INFO:root:epoch 12 train_loss 0.1599 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=12 train_loss=0.159938 val_loss=0.693147 | train_loss 0.159938 val_loss 0.693147
INFO:root:epoch 13 train_loss 0.0623 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=13 train_loss=0.062275 val_loss=0.693147 | train_loss 0.062275 val_loss 0.693147
INFO:root:epoch 14 train_loss 0.1574 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=14 train_loss=0.157388 val_loss=0.693147 | train_loss 0.157388 val_loss 0.693147
INFO:root:epoch 15 train_loss 0.2937 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=15 train_loss=0.293723 val_loss=0.693147 | train_loss 0.293723 val_loss 0.693147
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
{"f1": 0.0, "best_th": 0.2, "arch": "transformer", "d_model": 512, "pos_weight": null, "w_boundary": 1.0, "duv_mode": "both"}

>>> [2/5] Training Bass Base Model...
INFO:root:device mps amp=False precision=medium
INFO:root:train rows kept 3123319 removed 0 | val kept 347036 removed 0
INFO:root:class balance {'pos': 0, 'neg': 3123319}
WARNING:root:duv_mode=both with zero class-loss weights; setting w_vel_cls=0.5, w_dur_cls=0.5
INFO:root:epoch 1 train_loss 1.3638 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 1.4s
INFO:root:epoch=1 train_loss=1.363770 val_loss=0.693147 | train_loss 1.363770 val_loss 0.693147
INFO:root:epoch 2 train_loss 1.3131 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=2 train_loss=1.313135 val_loss=0.693147 | train_loss 1.313135 val_loss 0.693147
INFO:root:epoch 3 train_loss 0.7525 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=3 train_loss=0.752503 val_loss=0.693147 | train_loss 0.752503 val_loss 0.693147
INFO:root:epoch 4 train_loss 0.1175 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=4 train_loss=0.117534 val_loss=0.693147 | train_loss 0.117534 val_loss 0.693147
INFO:root:epoch 5 train_loss 0.6505 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.2s
INFO:root:epoch=5 train_loss=0.650506 val_loss=0.693147 | train_loss 0.650506 val_loss 0.693147
INFO:root:epoch 6 train_loss 0.7804 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=6 train_loss=0.780396 val_loss=0.693147 | train_loss 0.780396 val_loss 0.693147
INFO:root:epoch 7 train_loss 0.4365 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=7 train_loss=0.436512 val_loss=0.693147 | train_loss 0.436512 val_loss 0.693147
INFO:root:epoch 8 train_loss 0.0931 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=8 train_loss=0.093145 val_loss=0.693147 | train_loss 0.093145 val_loss 0.693147
INFO:root:epoch 9 train_loss 0.2059 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=9 train_loss=0.205884 val_loss=0.693147 | train_loss 0.205884 val_loss 0.693147
INFO:root:epoch 10 train_loss 0.3829 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=10 train_loss=0.382889 val_loss=0.693147 | train_loss 0.382889 val_loss 0.693147
INFO:root:epoch 11 train_loss 0.3402 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=11 train_loss=0.340207 val_loss=0.693147 | train_loss 0.340207 val_loss 0.693147
INFO:root:epoch 12 train_loss 0.1725 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=12 train_loss=0.172487 val_loss=0.693147 | train_loss 0.172487 val_loss 0.693147
INFO:root:epoch 13 train_loss 0.0546 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=13 train_loss=0.054571 val_loss=0.693147 | train_loss 0.054571 val_loss 0.693147
INFO:root:epoch 14 train_loss 0.1722 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=14 train_loss=0.172183 val_loss=0.693147 | train_loss 0.172183 val_loss 0.693147
INFO:root:epoch 15 train_loss 0.3305 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=15 train_loss=0.330506 val_loss=0.693147 | train_loss 0.330506 val_loss 0.693147
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
{"f1": 0.0, "best_th": 0.2, "arch": "transformer", "d_model": 512, "pos_weight": null, "w_boundary": 1.0, "duv_mode": "both"}

>>> [3/5] Training Piano Base Model...
INFO:root:device mps amp=False precision=medium
INFO:root:train rows kept 1462646 removed 0 | val kept 162517 removed 0
INFO:root:class balance {'pos': 0, 'neg': 1462646}
WARNING:root:duv_mode=both with zero class-loss weights; setting w_vel_cls=0.5, w_dur_cls=0.5
INFO:root:epoch 1 train_loss 1.3997 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 1.0s
INFO:root:epoch=1 train_loss=1.399728 val_loss=0.693147 | train_loss 1.399728 val_loss 0.693147
INFO:root:epoch 2 train_loss 1.3631 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.2s
INFO:root:epoch=2 train_loss=1.363107 val_loss=0.693147 | train_loss 1.363107 val_loss 0.693147
INFO:root:epoch 3 train_loss 0.8099 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=3 train_loss=0.809890 val_loss=0.693147 | train_loss 0.809890 val_loss 0.693147
INFO:root:epoch 4 train_loss 0.1282 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=4 train_loss=0.128159 val_loss=0.693147 | train_loss 0.128159 val_loss 0.693147
INFO:root:epoch 5 train_loss 0.5758 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.5s
INFO:root:epoch=5 train_loss=0.575823 val_loss=0.693147 | train_loss 0.575823 val_loss 0.693147
INFO:root:epoch 6 train_loss 0.7578 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.5s
INFO:root:epoch=6 train_loss=0.757752 val_loss=0.693147 | train_loss 0.757752 val_loss 0.693147
INFO:root:epoch 7 train_loss 0.5163 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=7 train_loss=0.516264 val_loss=0.693147 | train_loss 0.516264 val_loss 0.693147
INFO:root:epoch 8 train_loss 0.1487 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=8 train_loss=0.148693 val_loss=0.693147 | train_loss 0.148693 val_loss 0.693147
INFO:root:epoch 9 train_loss 0.1192 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=9 train_loss=0.119198 val_loss=0.693147 | train_loss 0.119198 val_loss 0.693147
INFO:root:epoch 10 train_loss 0.2297 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=10 train_loss=0.229735 val_loss=0.693147 | train_loss 0.229735 val_loss 0.693147
INFO:root:epoch 11 train_loss 0.2349 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=11 train_loss=0.234875 val_loss=0.693147 | train_loss 0.234875 val_loss 0.693147
INFO:root:epoch 12 train_loss 0.1365 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=12 train_loss=0.136510 val_loss=0.693147 | train_loss 0.136510 val_loss 0.693147
INFO:root:epoch 13 train_loss 0.0577 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.2s
INFO:root:epoch=13 train_loss=0.057720 val_loss=0.693147 | train_loss 0.057720 val_loss 0.693147
INFO:root:epoch 14 train_loss 0.1202 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=14 train_loss=0.120173 val_loss=0.693147 | train_loss 0.120173 val_loss 0.693147
INFO:root:epoch 15 train_loss 0.1628 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=15 train_loss=0.162829 val_loss=0.693147 | train_loss 0.162829 val_loss 0.693147
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
{"f1": 0.0, "best_th": 0.2, "arch": "transformer", "d_model": 512, "pos_weight": null, "w_boundary": 1.0, "duv_mode": "both"}

>>> [4/5] Training Strings Base Model...
INFO:root:device mps amp=False precision=medium
INFO:root:train rows kept 1949881 removed 0 | val kept 216654 removed 0
INFO:root:class balance {'pos': 0, 'neg': 1949881}
WARNING:root:duv_mode=both with zero class-loss weights; setting w_vel_cls=0.5, w_dur_cls=0.5
INFO:root:epoch 1 train_loss 1.3817 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 1.0s
INFO:root:epoch=1 train_loss=1.381659 val_loss=0.693147 | train_loss 1.381659 val_loss 0.693147
INFO:root:epoch 2 train_loss 1.3224 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=2 train_loss=1.322389 val_loss=0.693147 | train_loss 1.322389 val_loss 0.693147
INFO:root:epoch 3 train_loss 0.8130 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=3 train_loss=0.813018 val_loss=0.693147 | train_loss 0.813018 val_loss 0.693147
INFO:root:epoch 4 train_loss 0.1525 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=4 train_loss=0.152531 val_loss=0.693147 | train_loss 0.152531 val_loss 0.693147
INFO:root:epoch 5 train_loss 0.6273 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=5 train_loss=0.627350 val_loss=0.693147 | train_loss 0.627350 val_loss 0.693147
INFO:root:epoch 6 train_loss 0.8019 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=6 train_loss=0.801901 val_loss=0.693147 | train_loss 0.801901 val_loss 0.693147
INFO:root:epoch 7 train_loss 0.5347 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=7 train_loss=0.534739 val_loss=0.693147 | train_loss 0.534739 val_loss 0.693147
INFO:root:epoch 8 train_loss 0.1610 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=8 train_loss=0.161045 val_loss=0.693147 | train_loss 0.161045 val_loss 0.693147
INFO:root:epoch 9 train_loss 0.1504 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=9 train_loss=0.150384 val_loss=0.693147 | train_loss 0.150384 val_loss 0.693147
INFO:root:epoch 10 train_loss 0.2817 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=10 train_loss=0.281666 val_loss=0.693147 | train_loss 0.281666 val_loss 0.693147
INFO:root:epoch 11 train_loss 0.2811 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=11 train_loss=0.281070 val_loss=0.693147 | train_loss 0.281070 val_loss 0.693147
INFO:root:epoch 12 train_loss 0.1665 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=12 train_loss=0.166539 val_loss=0.693147 | train_loss 0.166539 val_loss 0.693147
INFO:root:epoch 13 train_loss 0.0732 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=13 train_loss=0.073154 val_loss=0.693147 | train_loss 0.073154 val_loss 0.693147
INFO:root:epoch 14 train_loss 0.1393 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=14 train_loss=0.139315 val_loss=0.693147 | train_loss 0.139315 val_loss 0.693147
INFO:root:epoch 15 train_loss 0.1953 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=15 train_loss=0.195268 val_loss=0.693147 | train_loss 0.195268 val_loss 0.693147
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
{"f1": 0.0, "best_th": 0.2, "arch": "transformer", "d_model": 512, "pos_weight": null, "w_boundary": 1.0, "duv_mode": "both"}

>>> [5/5] Training Drums Base Model...
INFO:root:device mps amp=False precision=medium
INFO:root:train rows kept 1095715 removed 0 | val kept 121747 removed 0
INFO:root:class balance {'pos': 0, 'neg': 1095715}
WARNING:root:duv_mode=both with zero class-loss weights; setting w_vel_cls=0.5, w_dur_cls=0.5
INFO:root:epoch 1 train_loss 1.1947 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 1.1s
INFO:root:epoch=1 train_loss=1.194722 val_loss=0.693147 | train_loss 1.194722 val_loss 0.693147
INFO:root:epoch 2 train_loss 1.4629 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=2 train_loss=1.462860 val_loss=0.693147 | train_loss 1.462860 val_loss 0.693147
INFO:root:epoch 3 train_loss 0.8732 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=3 train_loss=0.873248 val_loss=0.693147 | train_loss 0.873248 val_loss 0.693147
INFO:root:epoch 4 train_loss 0.1102 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=4 train_loss=0.110240 val_loss=0.693147 | train_loss 0.110240 val_loss 0.693147
INFO:root:epoch 5 train_loss 0.6600 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=5 train_loss=0.660026 val_loss=0.693147 | train_loss 0.660026 val_loss 0.693147
INFO:root:epoch 6 train_loss 0.8427 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=6 train_loss=0.842714 val_loss=0.693147 | train_loss 0.842714 val_loss 0.693147
INFO:root:epoch 7 train_loss 0.5707 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=7 train_loss=0.570655 val_loss=0.693147 | train_loss 0.570655 val_loss 0.693147
INFO:root:epoch 8 train_loss 0.1558 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=8 train_loss=0.155838 val_loss=0.693147 | train_loss 0.155838 val_loss 0.693147
INFO:root:epoch 9 train_loss 0.0783 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=9 train_loss=0.078343 val_loss=0.693147 | train_loss 0.078343 val_loss 0.693147
INFO:root:epoch 10 train_loss 0.1927 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=10 train_loss=0.192705 val_loss=0.693147 | train_loss 0.192705 val_loss 0.693147
INFO:root:epoch 11 train_loss 0.1935 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=11 train_loss=0.193527 val_loss=0.693147 | train_loss 0.193527 val_loss 0.693147
INFO:root:epoch 12 train_loss 0.0856 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=12 train_loss=0.085615 val_loss=0.693147 | train_loss 0.085615 val_loss 0.693147
INFO:root:epoch 13 train_loss 0.0407 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=13 train_loss=0.040682 val_loss=0.693147 | train_loss 0.040682 val_loss 0.693147
INFO:root:epoch 14 train_loss 0.0875 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=14 train_loss=0.087544 val_loss=0.693147 | train_loss 0.087544 val_loss 0.693147
INFO:root:epoch 15 train_loss 0.0997 val_f1 0.000 vel_mae 0.000 dur_mae 0.000 vel_acc 0.000 dur_acc 0.000 lr 1.00e-04 th 0.20 pos_rate 1.000 mean_p 0.500 time 0.1s
INFO:root:epoch=15 train_loss=0.099683 val_loss=0.693147 | train_loss 0.099683 val_loss 0.693147
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
DEBUG: torch is None: False
{"f1": 0.0, "best_th": 0.2, "arch": "transformer", "d_model": 512, "pos_weight": null, "w_boundary": 1.0, "duv_mode": "both"}

✓ All base models training complete!
Checkpoints saved to checkpoints/*_duv_raw.best.ckpt
